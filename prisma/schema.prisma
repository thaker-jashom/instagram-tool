generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Influencer {
  id               String            @id @default(uuid())
  username         String            @unique
  fullName         String
  bio              String?
  location         String?
  platform         Platform
  followerCount    Int
  engagementRate   Float?
  externalUserId   String
  profilePicUrl    String?
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
  followingCount   Int?              @map("following_count")
  postsCount       Int?              @map("posts_count")
  verified         Boolean?          @default(false)
  businessAccount  Boolean?          @default(false) @map("business_account")
  email            String?
  phone            String?
  website          String?
  platformMetadata Json?             @map("platform_metadata")
  qualityScore     Decimal?          @map("quality_score") @db.Decimal(3, 2)
  categories       String[]          @default([])
  cuisineTypes     String[]          @default([]) @map("cuisine_types")
  contentLanguages String[]          @default([]) @map("content_languages")
  locationCity     String?           @map("location_city") @db.VarChar(100)
  locationState    String?           @map("location_state") @db.VarChar(100)
  locationCountry  String?           @default("IN") @map("location_country") @db.VarChar(2)
  savedInfluencers SavedInfluencer[]

  @@unique([platform, externalUserId])
  @@index([followerCount])
  @@index([location])
}

model User {
  id               String            @id @default(uuid()) @db.Uuid
  email            String            @unique
  password         String
  createdAt        DateTime?         @default(now()) @db.Timestamp(6)
  savedInfluencers SavedInfluencer[]
  savedSearches    SavedSearch[]
}

model SavedSearch {
  id           String    @id @default(uuid()) @db.Uuid
  userId       String    @db.Uuid
  hashtags     String[]
  minFollowers Int?
  maxFollowers Int?
  city         String?
  country      String?
  createdAt    DateTime? @default(now()) @db.Timestamp(6)
  user         User      @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_ss")
}

model SavedInfluencer {
  id           String     @id @default(uuid()) @db.Uuid
  userId       String     @db.Uuid
  influencerId String
  createdAt    DateTime?  @default(now()) @db.Timestamp(6)
  influencer   Influencer @relation(fields: [influencerId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_influencer")
  user         User       @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_si")

  @@unique([userId, influencerId])
}

enum Platform {
  YOUTUBE
  INSTAGRAM
}
